# è·¨å­¦ç§‘çŸ¥è¯†å›¾è°±æ™ºèƒ½ä½“ - æŠ€æœ¯æ¶æ„æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ—¨åœ¨æ„å»ºä¸€ä¸ªè·¨å­¦ç§‘çŸ¥è¯†å›¾è°±æ™ºèƒ½ä½“ç³»ç»Ÿï¼Œç”¨æˆ·è¾“å…¥æ ¸å¿ƒæ¦‚å¿µè¯åï¼Œç³»ç»Ÿè‡ªåŠ¨æŒ–æ˜ä¸åŒå­¦ç§‘é¢†åŸŸçš„å…³è”çŸ¥è¯†ï¼Œæ„å»ºå¯è§†åŒ–çš„çŸ¥è¯†å›¾è°±ï¼Œå¹¶æ”¯æŒè¿›ä¸€æ­¥çš„çŸ¥è¯†æ¢ç´¢å¯¹è¯ã€‚

---

## ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Frontend (React + TypeScript)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  è¾“å…¥é¢æ¿     â”‚  â”‚  çŸ¥è¯†å›¾è°±å¯è§†åŒ–   â”‚  â”‚      RAGå¯¹è¯é¢æ¿              â”‚ â”‚
â”‚  â”‚  (æŸ¥è¯¢/ä¸Šä¼ )  â”‚  â”‚  (D3.js/Echarts) â”‚  â”‚   (LightRAG Chat Interface)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼ HTTP/WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           API Gateway (FastAPI)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ /api/search     â”‚  â”‚ /api/graph      â”‚  â”‚ /api/chat                   â”‚  â”‚
â”‚  â”‚ æ¦‚å¿µæ£€ç´¢æ¥å£    â”‚  â”‚ å›¾è°±æ“ä½œæ¥å£    â”‚  â”‚ RAGå¯¹è¯æ¥å£                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Module 1: æ£€ç´¢æ¨¡å—   â”‚ â”‚ Module 2: å›¾è°±  â”‚ â”‚  Module 3: RAGå¯¹è¯æ¨¡å—      â”‚
â”‚  (LangGraph Agent)    â”‚ â”‚ (LightRAG)      â”‚ â”‚  (LightRAG Query)           â”‚
â”‚                       â”‚ â”‚                 â”‚ â”‚                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ å­¦ç§‘åˆ†ç±»Agent     â”‚ â”‚ â”‚ â”‚ å®ä½“æå–    â”‚ â”‚ â”‚ â”‚  æ··åˆæ£€ç´¢               â”‚ â”‚
â”‚ â”‚ (Claude/GPT)      â”‚ â”‚ â”‚ â”‚ å…³ç³»æŠ½å–    â”‚ â”‚ â”‚ â”‚  (Naive+Local+Global)   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ å›¾è°±ç”Ÿæˆ    â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Tavilyå¹¶è¡Œæœç´¢    â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚  ä¸Šä¸‹æ–‡å¢å¼ºç”Ÿæˆ         â”‚ â”‚
â”‚ â”‚ (å¤šå­¦ç§‘æ£€ç´¢)      â”‚ â”‚ â”‚ â”‚ å›¾è°±ç²¾ç®€    â”‚ â”‚ â”‚ â”‚  (Context-Aware Gen)    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ ç›¸å…³æ€§è¿‡æ»¤  â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â”‚ æ ¡éªŒå±‚(Check)     â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â”‚ äº‹å®æ ¸æŸ¥/å»é‡     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                       â”‚
            â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Data Layer (Storage)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Neo4j             â”‚  â”‚   Redis             â”‚  â”‚   PostgreSQL        â”‚  â”‚
â”‚  â”‚   (å›¾æ•°æ®åº“)        â”‚  â”‚   (ç¼“å­˜/ä¼šè¯)       â”‚  â”‚   (å…ƒæ•°æ®/æ—¥å¿—)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ¨¡å—ä¸€ï¼šæ£€ç´¢æ¨¡å— (LangGraph Agentå·¥ä½œæµ)

### 1.1 æŠ€æœ¯é€‰å‹

| ç»„ä»¶ | æŠ€æœ¯é€‰æ‹© | è¯´æ˜ |
|------|----------|------|
| å·¥ä½œæµå¼•æ“ | LangGraph | æ„å»ºæœ‰çŠ¶æ€çš„å¤šAgentå·¥ä½œæµ |
| LLM | Claude 3.5 / GPT-4 | å­¦ç§‘åˆ†ç±»ä¸å†…å®¹ç†è§£ |
| æœç´¢å¼•æ“ | Tavily API | å®æ—¶ç½‘ç»œæ£€ç´¢ |
| çŠ¶æ€ç®¡ç† | LangGraph State | ç®¡ç†å·¥ä½œæµçŠ¶æ€ |

### 1.2 å·¥ä½œæµè®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LangGraph å·¥ä½œæµçŠ¶æ€å›¾                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [START]
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¦‚å¿µè¾“å…¥èŠ‚ç‚¹    â”‚  â—„â”€â”€ ç”¨æˆ·è¾“å…¥æ ¸å¿ƒæ¦‚å¿µè¯
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å­¦ç§‘åˆ†ç±»Agent   â”‚  â—„â”€â”€ è°ƒç”¨LLMåˆ†ææ¦‚å¿µæ¶‰åŠçš„å­¦ç§‘é¢†åŸŸ
â”‚                 â”‚      è¾“å‡º: {å­¦ç§‘åˆ—è¡¨, ç½®ä¿¡åº¦, å…³è”ç†ç”±}
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç¡®è®¤èŠ‚ç‚¹    â”‚  â—„â”€â”€ å‰ç«¯å±•ç¤ºå­¦ç§‘é€‰é¡¹ï¼Œç”¨æˆ·å¯å¢åˆ 
â”‚ (Human-in-Loop) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¹¶è¡Œæœç´¢ç¼–æ’å™¨  â”‚  â—„â”€â”€ ä¸ºæ¯ä¸ªå­¦ç§‘åˆ›å»ºæœç´¢ä»»åŠ¡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â–¼          â–¼          â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Tavily    â”‚â”‚Tavily    â”‚â”‚Tavily    â”‚â”‚Tavily    â”‚
â”‚æœç´¢:æ•°å­¦ â”‚â”‚æœç´¢:ç‰©ç† â”‚â”‚æœç´¢:ç”Ÿç‰© â”‚â”‚æœç´¢:...  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚          â”‚          â”‚          â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç»“æœèšåˆèŠ‚ç‚¹    â”‚  â—„â”€â”€ åˆå¹¶æ‰€æœ‰å­¦ç§‘çš„æœç´¢ç»“æœ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ ¡éªŒå±‚(Check)   â”‚  â—„â”€â”€ äº‹å®æ ¸æŸ¥ã€å»é‡ã€ç›¸å…³æ€§è¿‡æ»¤
â”‚ - å¹»è§‰æ£€æµ‹      â”‚
â”‚ - å†…å®¹å»é‡      â”‚
â”‚ - è´¨é‡è¯„åˆ†      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–‡æœ¬å—è¾“å‡º      â”‚  â—„â”€â”€ è¿”å›ç»“æ„åŒ–çš„æ–‡æœ¬å—åˆ—è¡¨
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
    [END] â”€â”€â–º ä¼ é€’ç»™æ¨¡å—äºŒ
```

### 1.3 æ ¸å¿ƒPromptæ¨¡æ¿

#### å­¦ç§‘åˆ†ç±»Prompt

```python
DISCIPLINE_CLASSIFICATION_PROMPT = """
ä½ æ˜¯ä¸€ä¸ªè·¨å­¦ç§‘çŸ¥è¯†ä¸“å®¶ã€‚ç»™å®šä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œåˆ†æå®ƒåœ¨ä¸åŒå­¦ç§‘é¢†åŸŸä¸­çš„åº”ç”¨å’Œå…³è”ã€‚

æ ¸å¿ƒæ¦‚å¿µ: {concept}

è¯·ä»ä»¥ä¸‹ç»´åº¦åˆ†æå¹¶è¿”å›JSONæ ¼å¼ç»“æœ:
1. è¯¥æ¦‚å¿µæœ€æ ¸å¿ƒçš„å­¦ç§‘å½’å±
2. è¯¥æ¦‚å¿µåœ¨å…¶ä»–å­¦ç§‘ä¸­çš„åº”ç”¨æˆ–å˜ä½“
3. æ¯ä¸ªå­¦ç§‘çš„å…³è”å¼ºåº¦(1-10)å’Œå…³è”ç†ç”±

è¾“å‡ºæ ¼å¼:
{
  "concept": "æ¦‚å¿µåç§°",
  "primary_discipline": "ä¸»è¦å­¦ç§‘",
  "related_disciplines": [
    {
      "name": "å­¦ç§‘åç§°",
      "relevance_score": 8,
      "reason": "å…³è”ç†ç”±",
      "search_keywords": ["æœç´¢å…³é”®è¯1", "æœç´¢å…³é”®è¯2"]
    }
  ]
}

è¦æ±‚:
- è‡³å°‘è¦†ç›–3ä¸ªä¸åŒå­¦ç§‘
- å¯»æ‰¾"è¿œäº²æ¦‚å¿µ"ï¼Œå³çœ‹ä¼¼ä¸ç›¸å…³ä½†æœ‰æ·±å±‚è”ç³»çš„å­¦ç§‘
- å…³è”ç†ç”±è¦å…·ä½“ä¸”æœ‰å­¦æœ¯ä»·å€¼
"""
```

#### æ ¡éªŒå±‚Prompt

```python
VALIDATION_PROMPT = """
ä½ æ˜¯ä¸€ä¸ªå­¦æœ¯å†…å®¹å®¡æ ¸ä¸“å®¶ã€‚è¯·å¯¹ä»¥ä¸‹æœç´¢ç»“æœè¿›è¡Œæ ¡éªŒ:

æœç´¢ç»“æœ:
{search_results}

æ ¸å¿ƒæ¦‚å¿µ: {concept}
ç›®æ ‡å­¦ç§‘: {discipline}

è¯·æ‰§è¡Œä»¥ä¸‹æ ¡éªŒ:
1. äº‹å®å‡†ç¡®æ€§: æ£€æŸ¥å†…å®¹æ˜¯å¦æœ‰æ˜æ˜¾çš„äº‹å®é”™è¯¯
2. ç›¸å…³æ€§: è¯„ä¼°å†…å®¹ä¸æ ¸å¿ƒæ¦‚å¿µçš„ç›¸å…³ç¨‹åº¦(1-10)
3. å­¦æœ¯ä»·å€¼: è¯„ä¼°å†…å®¹çš„å­¦æœ¯æ·±åº¦å’Œä»·å€¼(1-10)
4. å»é‡æ ‡è®°: æ ‡è®°é‡å¤æˆ–é«˜åº¦ç›¸ä¼¼çš„å†…å®¹

è¾“å‡ºæ ¼å¼:
{
  "validated_chunks": [
    {
      "content": "å†…å®¹æ‘˜è¦",
      "source_url": "æ¥æºURL",
      "relevance_score": 8,
      "academic_value": 7,
      "is_duplicate": false,
      "validation_notes": "æ ¡éªŒè¯´æ˜"
    }
  ],
  "rejected_chunks": [
    {
      "content": "è¢«æ‹’ç»çš„å†…å®¹",
      "rejection_reason": "æ‹’ç»åŸå› "
    }
  ]
}
"""
```

### 1.4 å®ç°æ–¹æ³•

1. **LangGraph Stateå®šä¹‰**
```python
class SearchState(TypedDict):
    concept: str                      # è¾“å…¥çš„æ ¸å¿ƒæ¦‚å¿µ
    disciplines: List[Dict]           # å­¦ç§‘åˆ†ç±»ç»“æœ
    user_confirmed: bool              # ç”¨æˆ·æ˜¯å¦ç¡®è®¤
    search_tasks: List[Dict]          # æœç´¢ä»»åŠ¡åˆ—è¡¨
    raw_results: List[Dict]           # åŸå§‹æœç´¢ç»“æœ
    validated_results: List[Dict]     # æ ¡éªŒåçš„ç»“æœ
    error_messages: List[str]         # é”™è¯¯ä¿¡æ¯
```

2. **å¹¶è¡Œæœç´¢å®ç°**
   - ä½¿ç”¨`asyncio.gather()`å¹¶è¡Œè°ƒç”¨Tavily API
   - æ¯ä¸ªå­¦ç§‘ç‹¬ç«‹æœç´¢ï¼Œè®¾ç½®è¶…æ—¶æœºåˆ¶
   - å¤±è´¥é‡è¯•æœºåˆ¶(æœ€å¤š3æ¬¡)

3. **æ ¡éªŒå±‚å®ç°**
   - ä½¿ç”¨LLMè¿›è¡Œäº‹å®æ ¸æŸ¥
   - åŸºäºembeddingçš„å†…å®¹å»é‡
   - è®¾ç½®è´¨é‡é˜ˆå€¼è¿‡æ»¤ä½è´¨é‡å†…å®¹

---

## æ¨¡å—äºŒï¼šçŸ¥è¯†å›¾è°±æ„å»º (LightRAGé›†æˆ)

### 2.1 æŠ€æœ¯é€‰å‹

| ç»„ä»¶ | æŠ€æœ¯é€‰æ‹© | è¯´æ˜ |
|------|----------|------|
| RAGæ¡†æ¶ | LightRAG | å›¾å¢å¼ºRAGæ¡†æ¶ |
| å›¾æ•°æ®åº“ | Neo4j | å­˜å‚¨çŸ¥è¯†å›¾è°± |
| å‘é‡æ•°æ®åº“ | å†…ç½®/Milvus | å­˜å‚¨æ–‡æœ¬embedding |
| LLM | Claude 3.5 / GPT-4 | å®ä½“å…³ç³»æå– |

### 2.2 LightRAGé›†æˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LightRAG å¤„ç†æµç¨‹                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [æ–‡æœ¬å—è¾“å…¥] â—„â”€â”€ æ¥è‡ªæ¨¡å—ä¸€çš„æ ¡éªŒåæ–‡æœ¬
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–‡æœ¬é¢„å¤„ç†          â”‚
â”‚  - åˆ†å—(Chunking)   â”‚
â”‚  - æ¸…æ´—æ ¼å¼åŒ–       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®ä½“æå–(NER)      â”‚  â—„â”€â”€ LLM + Prompt Engineering
â”‚  - æ¦‚å¿µå®ä½“         â”‚
â”‚  - äººç‰©å®ä½“         â”‚
â”‚  - å­¦ç§‘å®ä½“         â”‚
â”‚  - åº”ç”¨å®ä½“         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å…³ç³»æŠ½å–(RE)       â”‚  â—„â”€â”€ LLMæ¨ç†å…³ç³»ç±»å‹
â”‚  - å±äº(belongs_to) â”‚
â”‚  - åº”ç”¨äº(applied_to)â”‚
â”‚  - æ´¾ç”Ÿè‡ª(derived_from)â”‚
â”‚  - ç›¸ä¼¼äº(similar_to)â”‚
â”‚  - å½±å“(influences) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  çŸ¥è¯†å›¾è°±ç”Ÿæˆ       â”‚
â”‚  - èŠ‚ç‚¹åˆ›å»º         â”‚
â”‚  - è¾¹åˆ›å»º           â”‚
â”‚  - å±æ€§å¡«å……         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å›¾è°±ç²¾ç®€           â”‚  â—„â”€â”€ ä¿ç•™ä¸æ ¸å¿ƒæ¦‚å¿µç›¸å…³çš„èŠ‚ç‚¹
â”‚  - ç›¸å…³æ€§è¯„åˆ†       â”‚
â”‚  - è·ç¦»è¿‡æ»¤         â”‚
â”‚  - é‡è¦åº¦æ’åº       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æŒä¹…åŒ–å­˜å‚¨         â”‚
â”‚  - Neo4jå†™å…¥        â”‚
â”‚  - å‘é‡ç´¢å¼•æ›´æ–°     â”‚
â”‚  - æ‘˜è¦ç”Ÿæˆå­˜å‚¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 æ ¸å¿ƒPromptæ¨¡æ¿

#### å®ä½“å…³ç³»æå–Prompt

```python
ENTITY_EXTRACTION_PROMPT = """
ä½ æ˜¯ä¸€ä¸ªçŸ¥è¯†å›¾è°±æ„å»ºä¸“å®¶ã€‚è¯·ä»ä»¥ä¸‹æ–‡æœ¬ä¸­æå–å®ä½“å’Œå…³ç³»ã€‚

æ–‡æœ¬å†…å®¹:
{text_chunk}

æ ¸å¿ƒæ¦‚å¿µ: {concept}
ç›¸å…³å­¦ç§‘: {discipline}

è¯·æå–:
1. å®ä½“(Entities): æ¦‚å¿µã€äººç‰©ã€ç†è®ºã€åº”ç”¨ã€å­¦ç§‘ç­‰
2. å…³ç³»(Relations): å®ä½“ä¹‹é—´çš„å…³è”

è¾“å‡ºæ ¼å¼:
{
  "entities": [
    {
      "id": "e1",
      "name": "å®ä½“åç§°",
      "type": "concept|person|theory|application|discipline",
      "description": "ç®€çŸ­æè¿°",
      "discipline": "æ‰€å±å­¦ç§‘",
      "properties": {"key": "value"}
    }
  ],
  "relations": [
    {
      "source": "e1",
      "target": "e2", 
      "relation_type": "belongs_to|applied_to|derived_from|similar_to|influences",
      "description": "å…³ç³»æè¿°",
      "weight": 0.8
    }
  ]
}

æå–è¦æ±‚:
- å®ä½“åç§°è¦è§„èŒƒåŒ–(é¿å…åŒä¸€å®ä½“å¤šç§å†™æ³•)
- å…³ç³»è¦æœ‰æ˜ç¡®çš„å­¦æœ¯ä¾æ®
- é‡ç‚¹å…³æ³¨è·¨å­¦ç§‘çš„å…³è”å…³ç³»
"""
```

### 2.4 Neo4jæ•°æ®æ¨¡å‹

```cypher
// èŠ‚ç‚¹ç±»å‹
(:Concept {
  id: string,
  name: string,
  description: string,
  discipline: string,
  embedding: list<float>,
  created_at: datetime
})

(:Discipline {
  id: string,
  name: string,
  description: string
})

(:Person {
  id: string,
  name: string,
  contribution: string
})

// å…³ç³»ç±»å‹
(:Concept)-[:BELONGS_TO]->(:Discipline)
(:Concept)-[:DERIVED_FROM]->(:Concept)
(:Concept)-[:SIMILAR_TO {weight: float}]->(:Concept)
(:Concept)-[:APPLIED_IN]->(:Application)
(:Person)-[:PROPOSED]->(:Concept)
```

### 2.5 å›¾è°±ç²¾ç®€ç®—æ³•

```python
def prune_graph(graph, core_concept, max_distance=3, min_relevance=0.5):
    """
    å›¾è°±ç²¾ç®€ç®—æ³•
    1. ä»¥æ ¸å¿ƒæ¦‚å¿µä¸ºä¸­å¿ƒï¼Œè®¡ç®—æ‰€æœ‰èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„è·ç¦»
    2. è¿‡æ»¤è¶…è¿‡max_distanceçš„èŠ‚ç‚¹
    3. åŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦è®¡ç®—ç›¸å…³æ€§åˆ†æ•°
    4. è¿‡æ»¤ç›¸å…³æ€§ä½äºmin_relevanceçš„èŠ‚ç‚¹
    5. ä¿ç•™é‡è¦çš„æ¡¥æ¥èŠ‚ç‚¹(è¿æ¥ä¸åŒå­¦ç§‘çš„èŠ‚ç‚¹)
    """
    pass
```

---

## æ¨¡å—ä¸‰ï¼šå‰ç«¯å¯è§†åŒ–

### 3.1 æŠ€æœ¯é€‰å‹

| ç»„ä»¶ | æŠ€æœ¯é€‰æ‹© | è¯´æ˜ |
|------|----------|------|
| å‰ç«¯æ¡†æ¶ | React 18 + TypeScript | ç°ä»£åŒ–å‰ç«¯æ¡†æ¶ |
| çŠ¶æ€ç®¡ç† | Zustand | è½»é‡çº§çŠ¶æ€ç®¡ç† |
| å›¾è°±å¯è§†åŒ– | D3.js / ECharts | äº¤äº’å¼å›¾è°±å±•ç¤º |
| UIç»„ä»¶åº“ | Tailwind CSS + Shadcn/ui | ç°ä»£åŒ–UI |
| HTTPå®¢æˆ·ç«¯ | Axios / React Query | APIè°ƒç”¨ |
| WebSocket | Socket.io-client | å®æ—¶é€šä¿¡ |

### 3.2 é¡µé¢å¸ƒå±€è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Header (Logo + å¯¼èˆª)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                          â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚     çŸ¥è¯†å›¾è°±å¯è§†åŒ–åŒºåŸŸ     â”‚  â”‚      RAGå¯¹è¯åŒºåŸŸ             â”‚ â”‚
â”‚  â”‚                          â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚èŠ‚ç‚¹ â”‚â”€â”€â”€â”€â”‚èŠ‚ç‚¹ â”‚     â”‚  â”‚  â”‚ å¯¹è¯å†å²               â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜     â”‚  â”‚  â”‚                        â”‚  â”‚ â”‚
â”‚  â”‚      \      /           â”‚  â”‚  â”‚ User: ä»€ä¹ˆæ˜¯ç†µ?        â”‚  â”‚ â”‚
â”‚  â”‚       \    /            â”‚  â”‚  â”‚ AI: ç†µæ˜¯...           â”‚  â”‚ â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”            â”‚  â”‚  â”‚                        â”‚  â”‚ â”‚
â”‚  â”‚      â”‚æ ¸å¿ƒ â”‚            â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚      â”‚æ¦‚å¿µ â”‚            â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”˜            â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚       /    \            â”‚  â”‚  â”‚ è¾“å…¥æ¡†                 â”‚  â”‚ â”‚
â”‚  â”‚      /      \           â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”     â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  â”‚èŠ‚ç‚¹ â”‚â”€â”€â”€â”€â”‚èŠ‚ç‚¹ â”‚     â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”˜     â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚                          â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  [å›¾è°±æ§åˆ¶é¢æ¿]          â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚  ç¼©æ”¾ | å¸ƒå±€ | ç­›é€‰      â”‚  â”‚                              â”‚ â”‚
â”‚  â”‚                          â”‚  â”‚                              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        åŠŸèƒ½åŒº (åº•éƒ¨)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ“ ä¸Šä¼ æ–‡ä»¶    â”‚  â”‚  ğŸ” æ¦‚å¿µæŸ¥è¯¢    â”‚  â”‚  âš™ï¸ è®¾ç½®          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 ç»„ä»¶æ¶æ„

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ GraphVisualization/     # å›¾è°±å¯è§†åŒ–ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ForceGraph.tsx      # D3åŠ›å¯¼å‘å›¾
â”‚   â”‚   â”œâ”€â”€ GraphControls.tsx   # å›¾è°±æ§åˆ¶é¢æ¿
â”‚   â”‚   â”œâ”€â”€ NodeDetail.tsx      # èŠ‚ç‚¹è¯¦æƒ…å¼¹çª—
â”‚   â”‚   â””â”€â”€ Legend.tsx          # å›¾ä¾‹
â”‚   â”‚
â”‚   â”œâ”€â”€ ChatPanel/              # RAGå¯¹è¯ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatHistory.tsx     # å¯¹è¯å†å²
â”‚   â”‚   â”œâ”€â”€ ChatInput.tsx       # è¾“å…¥æ¡†
â”‚   â”‚   â””â”€â”€ MessageBubble.tsx   # æ¶ˆæ¯æ°”æ³¡
â”‚   â”‚
â”‚   â”œâ”€â”€ SearchPanel/            # æœç´¢é¢æ¿
â”‚   â”‚   â”œâ”€â”€ ConceptInput.tsx    # æ¦‚å¿µè¾“å…¥
â”‚   â”‚   â”œâ”€â”€ DisciplineSelector.tsx # å­¦ç§‘é€‰æ‹©å™¨
â”‚   â”‚   â””â”€â”€ SearchProgress.tsx  # æœç´¢è¿›åº¦
â”‚   â”‚
â”‚   â””â”€â”€ common/                 # é€šç”¨ç»„ä»¶
â”‚       â”œâ”€â”€ Header.tsx
â”‚       â”œâ”€â”€ Loading.tsx
â”‚       â””â”€â”€ ErrorBoundary.tsx
```

### 3.4 å›¾è°±äº¤äº’åŠŸèƒ½

1. **èŠ‚ç‚¹äº¤äº’**
   - ç‚¹å‡»èŠ‚ç‚¹: æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
   - åŒå‡»èŠ‚ç‚¹: ä»¥è¯¥èŠ‚ç‚¹ä¸ºä¸­å¿ƒé‡æ–°å¸ƒå±€
   - æ‹–æ‹½èŠ‚ç‚¹: è°ƒæ•´ä½ç½®
   - æ‚¬åœèŠ‚ç‚¹: é«˜äº®å…³è”è¾¹

2. **å›¾è°±æ§åˆ¶**
   - ç¼©æ”¾: æ»šè½®ç¼©æ”¾
   - å¹³ç§»: æ‹–æ‹½ç”»å¸ƒ
   - å¸ƒå±€åˆ‡æ¢: åŠ›å¯¼å‘/å±‚æ¬¡/ç¯å½¢
   - å­¦ç§‘ç­›é€‰: æŒ‰å­¦ç§‘æ˜¾ç¤º/éšè—èŠ‚ç‚¹

3. **æœç´¢å®šä½**
   - æœç´¢èŠ‚ç‚¹å¹¶é«˜äº®
   - è·³è½¬åˆ°æŒ‡å®šèŠ‚ç‚¹

---

## äº‘åŸç”Ÿæ¶æ„è®¾è®¡

### 4.1 å®¹å™¨åŒ–éƒ¨ç½²æ¶æ„

```yaml
# docker-compose.yml æ¶æ„æ¦‚è§ˆ

services:
  # å‰ç«¯æœåŠ¡
  frontend:
    build: ./frontend
    ports: ["3000:3000"]
    depends_on: [api-gateway]
  
  # APIç½‘å…³
  api-gateway:
    build: ./backend/api-gateway
    ports: ["8000:8000"]
    depends_on: [search-service, graph-service, chat-service]
  
  # æ£€ç´¢æœåŠ¡
  search-service:
    build: ./backend/search-service
    environment:
      - TAVILY_API_KEY=${TAVILY_API_KEY}
      - LLM_API_KEY=${LLM_API_KEY}
  
  # å›¾è°±æœåŠ¡
  graph-service:
    build: ./backend/graph-service
    depends_on: [neo4j]
  
  # å¯¹è¯æœåŠ¡
  chat-service:
    build: ./backend/chat-service
    depends_on: [neo4j, redis]
  
  # æ•°æ®å­˜å‚¨
  neo4j:
    image: neo4j:5.x
    ports: ["7474:7474", "7687:7687"]
  
  redis:
    image: redis:7-alpine
    ports: ["6379:6379"]
  
  postgres:
    image: postgres:15-alpine
    ports: ["5432:5432"]
```

### 4.2 æœåŠ¡é—´é€šä¿¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTP/REST      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚   API Gateway   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                      â”‚                      â”‚
                    â–¼                      â–¼                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Search Serviceâ”‚      â”‚ Graph Service â”‚      â”‚ Chat Service  â”‚
            â”‚   (gRPC)      â”‚      â”‚   (gRPC)      â”‚      â”‚  (WebSocket)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                      â”‚                      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                      â–¼                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    Redis      â”‚      â”‚    Neo4j      â”‚      â”‚   Postgres    â”‚
            â”‚   (Cache)     â”‚      â”‚   (Graph DB)  â”‚      â”‚   (Metadata)  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 ç¯å¢ƒé…ç½®

```bash
# .env é…ç½®é¡¹
# LLM API
LLM_PROVIDER=anthropic  # anthropic / openai
ANTHROPIC_API_KEY=xxx
OPENAI_API_KEY=xxx

# Tavilyæœç´¢
TAVILY_API_KEY=xxx

# Neo4j
NEO4J_URI=bolt://neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=xxx

# Redis
REDIS_URL=redis://redis:6379

# PostgreSQL
POSTGRES_URL=postgresql://user:pass@postgres:5432/knowledge_graph
```

---

## APIæ¥å£è®¾è®¡

### 5.1 æ¦‚å¿µæœç´¢ç›¸å…³API

#### POST /api/search/classify
åˆ†ææ¦‚å¿µå¹¶è¿”å›å­¦ç§‘åˆ†ç±»

**è¯·æ±‚ä½“:**
```json
{
  "concept": "ç†µ",
  "max_disciplines": 5
}
```

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "concept": "ç†µ",
    "primary_discipline": "çƒ­åŠ›å­¦",
    "disciplines": [
      {
        "name": "çƒ­åŠ›å­¦",
        "relevance_score": 10,
        "reason": "ç†µçš„åŸå§‹å®šä¹‰æ¥æº",
        "search_keywords": ["çƒ­åŠ›å­¦ç†µ", "å…‹åŠ³ä¿®æ–¯ç†µ"]
      },
      {
        "name": "ä¿¡æ¯è®º",
        "relevance_score": 9,
        "reason": "é¦™å†œç†µæ˜¯ä¿¡æ¯è®ºæ ¸å¿ƒæ¦‚å¿µ",
        "search_keywords": ["ä¿¡æ¯ç†µ", "é¦™å†œç†µ"]
      }
    ]
  }
}
```

#### POST /api/search/start
å¯åŠ¨è·¨å­¦ç§‘æœç´¢ä»»åŠ¡

**è¯·æ±‚ä½“:**
```json
{
  "concept": "ç†µ",
  "disciplines": ["çƒ­åŠ›å­¦", "ä¿¡æ¯è®º", "ç»Ÿè®¡åŠ›å­¦"],
  "search_depth": "medium"
}
```

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "task_id": "uuid-xxx",
    "status": "processing",
    "estimated_time": 30
  }
}
```

#### GET /api/search/status/{task_id}
æŸ¥è¯¢æœç´¢ä»»åŠ¡çŠ¶æ€

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "task_id": "uuid-xxx",
    "status": "completed",
    "progress": 100,
    "result": {
      "total_chunks": 25,
      "chunks_by_discipline": {
        "çƒ­åŠ›å­¦": 8,
        "ä¿¡æ¯è®º": 10,
        "ç»Ÿè®¡åŠ›å­¦": 7
      }
    }
  }
}
```

#### GET /api/search/results/{task_id}
è·å–æœç´¢ç»“æœ

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "chunks": [
      {
        "id": "chunk-1",
        "content": "ç†µåœ¨çƒ­åŠ›å­¦ä¸­è¡¨ç¤º...",
        "discipline": "çƒ­åŠ›å­¦",
        "source_url": "https://...",
        "relevance_score": 0.95
      }
    ]
  }
}
```

### 5.2 çŸ¥è¯†å›¾è°±ç›¸å…³API

#### POST /api/graph/build
ä»æ–‡æœ¬å—æ„å»ºçŸ¥è¯†å›¾è°±

**è¯·æ±‚ä½“:**
```json
{
  "task_id": "uuid-xxx",
  "concept": "ç†µ",
  "prune_config": {
    "max_distance": 3,
    "min_relevance": 0.5
  }
}
```

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "graph_id": "graph-xxx",
    "status": "building"
  }
}
```

#### GET /api/graph/{graph_id}
è·å–çŸ¥è¯†å›¾è°±æ•°æ®

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "nodes": [
      {
        "id": "n1",
        "name": "ç†µ",
        "type": "concept",
        "discipline": "çƒ­åŠ›å­¦",
        "description": "è¡¨ç¤ºç³»ç»Ÿæ··ä¹±ç¨‹åº¦çš„ç‰©ç†é‡",
        "x": 100,
        "y": 200
      }
    ],
    "edges": [
      {
        "id": "e1",
        "source": "n1",
        "target": "n2",
        "relation": "derived_from",
        "weight": 0.8,
        "description": "æ¦‚å¿µæ¼”åŒ–å…³ç³»"
      }
    ],
    "metadata": {
      "total_nodes": 50,
      "total_edges": 75,
      "disciplines": ["çƒ­åŠ›å­¦", "ä¿¡æ¯è®º"]
    }
  }
}
```

#### PUT /api/graph/{graph_id}/node/{node_id}
æ›´æ–°èŠ‚ç‚¹ä¿¡æ¯

#### DELETE /api/graph/{graph_id}/node/{node_id}
åˆ é™¤èŠ‚ç‚¹

#### GET /api/graph/{graph_id}/neighbors/{node_id}
è·å–èŠ‚ç‚¹çš„é‚»å±…èŠ‚ç‚¹

### 5.3 RAGå¯¹è¯ç›¸å…³API

#### POST /api/chat/session
åˆ›å»ºå¯¹è¯ä¼šè¯

**è¯·æ±‚ä½“:**
```json
{
  "graph_id": "graph-xxx",
  "concept": "ç†µ"
}
```

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "session_id": "session-xxx"
  }
}
```

#### POST /api/chat/message
å‘é€å¯¹è¯æ¶ˆæ¯

**è¯·æ±‚ä½“:**
```json
{
  "session_id": "session-xxx",
  "message": "ç†µåœ¨æœºå™¨å­¦ä¹ ä¸­æœ‰ä»€ä¹ˆåº”ç”¨?",
  "search_mode": "hybrid"
}
```

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "message_id": "msg-xxx",
    "response": "ç†µåœ¨æœºå™¨å­¦ä¹ ä¸­æœ‰å¤šç§åº”ç”¨...",
    "sources": [
      {
        "node_id": "n5",
        "node_name": "äº¤å‰ç†µæŸå¤±",
        "relevance": 0.92
      }
    ],
    "related_nodes": ["n5", "n6", "n7"]
  }
}
```

#### WebSocket /ws/chat/{session_id}
å®æ—¶å¯¹è¯WebSocketè¿æ¥

**æ¶ˆæ¯æ ¼å¼:**
```json
// å®¢æˆ·ç«¯å‘é€
{
  "type": "message",
  "content": "é—®é¢˜å†…å®¹"
}

// æœåŠ¡ç«¯å“åº”(æµå¼)
{
  "type": "stream",
  "content": "éƒ¨åˆ†å›ç­”...",
  "done": false
}

{
  "type": "stream",
  "content": "å®Œæ•´å›ç­”",
  "done": true,
  "sources": [...]
}
```

#### GET /api/chat/history/{session_id}
è·å–å¯¹è¯å†å²

### 5.4 æ–‡ä»¶ä¸Šä¼ API

#### POST /api/upload
ä¸Šä¼ æ–‡ä»¶ä½œä¸ºçŸ¥è¯†æº

**è¯·æ±‚ä½“:** multipart/form-data
- file: ä¸Šä¼ çš„æ–‡ä»¶(PDF, TXT, MD)
- concept: å…³è”çš„æ ¸å¿ƒæ¦‚å¿µ

**å“åº”ä½“:**
```json
{
  "code": 200,
  "data": {
    "file_id": "file-xxx",
    "filename": "document.pdf",
    "status": "processing"
  }
}
```

### 5.5 ç³»ç»Ÿç®¡ç†API

#### GET /api/health
å¥åº·æ£€æŸ¥

#### GET /api/stats
è·å–ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯

---

## å¼€å‘è®¡åˆ’ä¸åˆ†å·¥å»ºè®®

### 6.1 å¼€å‘é˜¶æ®µ

| é˜¶æ®µ | æ—¶é—´ | ä¸»è¦ä»»åŠ¡ |
|------|------|----------|
| Phase 1 | Week 1-2 | åŸºç¡€æ¶æ„æ­å»ºã€Dockerç¯å¢ƒã€APIæ¡†æ¶ |
| Phase 2 | Week 2-3 | æ£€ç´¢æ¨¡å—å¼€å‘ã€LangGraphå·¥ä½œæµ |
| Phase 3 | Week 3-4 | LightRAGé›†æˆã€çŸ¥è¯†å›¾è°±æ„å»º |
| Phase 4 | Week 4-5 | å‰ç«¯å¼€å‘ã€å›¾è°±å¯è§†åŒ– |
| Phase 5 | Week 5-6 | é›†æˆæµ‹è¯•ã€ä¼˜åŒ–ã€æ–‡æ¡£ |

### 6.2 å›¢é˜Ÿåˆ†å·¥å»ºè®®

**ç®—æ³•/Agentç»„:**
- LangGraphå·¥ä½œæµå¼€å‘
- Promptå·¥ç¨‹ä¸ä¼˜åŒ–
- LightRAGé›†æˆä¸è°ƒä¼˜
- å›¾è°±ç²¾ç®€ç®—æ³•

**æ¶æ„/å·¥ç¨‹ç»„:**
- Dockerå®¹å™¨åŒ–éƒ¨ç½²
- APIè®¾è®¡ä¸å®ç°
- æ•°æ®åº“è®¾è®¡ä¸ç®¡ç†
- å‰ç«¯å¼€å‘ä¸å¯è§†åŒ–

---

## é™„å½•

### A. æŠ€æœ¯æ ˆç‰ˆæœ¬

| æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|
| Python | 3.11+ |
| Node.js | 18+ |
| React | 18.x |
| FastAPI | 0.100+ |
| LangGraph | 0.1.x |
| LightRAG | latest |
| Neo4j | 5.x |
| Redis | 7.x |
| Docker | 24.x |
| Docker Compose | 2.x |

### B. å‚è€ƒèµ„æº

- LangGraphæ–‡æ¡£: https://langchain-ai.github.io/langgraph/
- LightRAG GitHub: https://github.com/HKUDS/LightRAG
- Neo4jæ–‡æ¡£: https://neo4j.com/docs/
- D3.jsæ–‡æ¡£: https://d3js.org/
- Tavily API: https://tavily.com/
